# Websockets
## 개념
- 양방향 통신을 쉽게 만들어주는 프로토콜
- tcp ip 기반
- 계속 연결이 열려 있다.

## 코드 예시
```python
# 의존성
from fastapi.websockets import WebSocket

clients:List[WebSocket] = []
# 웹소켓 리스너는 이런 식으로 사용.
@app.websocket("/chat")
async def websocket_endpoint(websocket:WebSocket):
    await websocket.accept()
    clients.append(websocket)
    while True:
        data = await websocket.receive_text()
        for client in clients:
            await client.send_text(data)
```
- 클라이언트단 코드
```javascript
            // 웹소켓 객체를 선언 어느 엔드포인트와 통신을 맺을건지 정해둔다.
            var ws = new WebSocket("ws://localhost:8000/chat");
            // 메시지가 수신될 때마다 수행할 함수
            ws.onmessage = function(event) {
                var messages = document.getElementById('messages')
                var message = document.createElement('li')
                // 서버에서 송신한 데이터는 event.data 에 담긴다.
                var content = document.createTextNode(event.data)
                message.appendChild(content)
                messages.appendChild(message)
            };
            function sendMessage(event) {
                var input = document.getElementById("messageText")
                // 송신
                ws.send(input.value)
                input.value = ''
                event.preventDefault()
            }
```